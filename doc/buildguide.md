# Build Guide

![coron47plus_main00](/images/main_00.jpg)

coron47plusのビルドガイドになります。
coron47plusは中央に25mmトラックボールを搭載したロウスタッガード40%キーボードです。中央にボールを配置することで、ホームポジションから手を余り動かさずにカーソル操作が可能になるとともに、肩が少し開かれた状態になり、自然な姿勢で打鍵することができるようになります。

## 部品
### キット付属品

|名前|数|備考|
|---|---|---|
|実装済基板|1枚||
|スイッチプレート|1枚||
|ボトムプレート①|1枚||
|ボトムプレート②|1枚||
|マウスセンサー（ADNS-5050）|1個||
|センサーレンズ|1個||
|M2ねじ 3mm|15本|
|M2ねじ 8mm|3本||
|M2スペーサー 8mm|6本||
|M2スペーサー 3mm|3本||
|M2スペーサー（オス―メス） 3mm|6本||
|ゴム脚|4個||
|ボールケース|1個||
|25mmビリヤードボール|1個||

### キット以外に必要なもの

下記パーツは[遊舎工房](https://shop.yushakobo.jp/)、[TALP KEYBOARD](https://talpkeyboard.net/)、[Daily Craft Keyboard](https://shop.dailycraft.jp/)などで揃えることが可能です。

|名前|数|備考|
|---|---|---|
|MicroUSB or USB-TypeCケーブル|1本||
|ProMicro|1個||
|コンスル―（2.5mm×12ピン）|2本||
|キースイッチ|44～47個（レイアウトによる）|MX互換|
|キーキャップ|44～47個（レイアウトによる）|MX互換|
|スタビライザー|1～3個（レイアウトによる）||

各ショップの在庫状況に応じて検討ください。


## 組み立て
### 0. 部品確認

  まずはキット付属品に記載されたパーツが揃っているか確認ください。  
  その他上述の「キット以外に必要なもの」および「オプション部品」を揃えた上で組み立てに取り掛かってください。

  - タブ付きPCBの場合にはタブを割って切り離し、切断面を軽くヤスリがけしてください。
  - PCB、スイッチプレートの側面を油性マジックなどで黒く塗ると見栄えが良くなります。ぜひ試してみてください。

  上:塗装済み / 下:未塗装  
  ![coron47plus_bg_00](/images/bg_00.jpg)


### 1. ProMicro

  ProMicroの準備をします。写真の向きでコンスル―をはんだ付けします。  
  **cocot46plusとはコンスル―を取り付ける向きが逆になりますのでご注意ください。**  
  コンスル―には向きがあるので注意してください。コンスル―の向きについては[こちら](https://yushakobo.zendesk.com/hc/ja/articles/360044233974-%E3%82%B3%E3%83%B3%E3%82%B9%E3%83%AB%E3%83%BC-%E3%82%B9%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B0%E3%83%94%E3%83%B3%E3%83%98%E3%83%83%E3%83%80-%E3%81%AE%E5%8F%96%E3%82%8A%E4%BB%98%E3%81%91%E6%96%B9%E3%82%92%E6%95%99%E3%81%88%E3%81%A6%E4%B8%8B%E3%81%95%E3%81%84)を参照ださい。  
  USB Type-C版のProMicroにも対応しています。マイクロUSBの場合、USBコネクタがもげやすいので、適宜補強をしてからはんだ付けを行ってください。

  ![coron47plus_bg_01_1](/images/bg_01_1.jpg)

### 2. マウスセンサー

  マウスセンサー（ADNS-5050）を基板裏面から写真の向きに設置し、表面からはんだ付けを行います。シルクの●●印と基板の●●印の位置が合うように注意してください。  
  ![coron47plus_bg_02_1](/images/bg_02_1.jpg)

  センサーの脚がしっかり奥まで入った状態で、浮かないようにマスキングテープなどで固定します。  
  ![coron47plus_bg_02_2](/images/bg_02_2.jpg)

  表面から8本の脚をはんだ付けします。  
  ![coron47plus_bg_02_3](/images/bg_02_3.jpg)

  センサーに貼られているテープを剥がし、表面からレンズを付けます。  
  ![coron47plus_bg_02_4](/images/bg_02_4.jpg)


### 3. 組み立て

  ボトムプレート②に3mmネジで3mmスペーサー（オス-メス）を固定します。  
  ![coron47plus_bg_03_1](/images/bg_03_1.jpg)

  ボトムプレート①をボトムプレート②に重ね、8mmスペーサー×6本、3mmスペーサー×3本を固定します。外周が8mm、中央ボールケース下が3mmスペーサーです。  
  ![coron47plus_bg_03_2](/images/bg_03_2.jpg)

  レイアウトに応じてスタビライザーを取り付けます。スタビライザーは予めルブをしておくことをお勧めします。  
  ![coron47plus_bg_03_3](/images/bg_03_3.jpg)

  スイッチプレートと基板を重ね、隅から順番にキースイッチをはめていきます。スイッチの向きに気を付けて、またスイッチの脚が曲がらないように真っすぐに差し込むようにしてください。特にマルチレイアウトに対応している部分はスイッチの位置、向きを間違えやすいので注意してください。  
  ![coron47plus_bg_03_4](/images/bg_03_4.jpg)

  スイッチを差し込んだスイッチプレート&基板を、ボトムプレートの上に重ねます。外周の6か所を3mmネジで固定します。  
  ![coron47plus_bg_03_5](/images/bg_03_5.jpg)

  センサーにレンズを重ね、さらにその上からトラックボールケースを被せます。トラックボールケースの隅の3か所を8mmネジで固定します。  
  ![coron47plus_bg_03_6](/images/bg_03_6.jpg)

  ボトムプレートにゴム脚を貼り付け、お好みのキーキャップ、25mmボールを付けて完成です！  
  ![coron47plus_bg_03_7](/images/bg_03_7.jpg)


### マルチレイアウト対応

  最下段のレイアウトについて、デフォルトでは「2u+1u+1u+2u」となっていますが、スイッチプレートを加工することで他のレイアウトに変更することも可能です。**スイッチプレートを加工した場合、デフォルトのレイアウトに戻した際にスイッチが緩くなる恐れがあります。予めご了承の上加工ください。**  
  ![coron47plus_layout](/images/coron47plus_layout.jpg)

  - レイアウト①  
      デフォルトのレイアウトです。トラックボール下に1uサイズのキーが二つ並びます。スイッチプレートの加工は不要です。  
      ![coron47plus_layout_01](/images/layout_01.jpg)

  - レイアウト②  
    6.25uのロングスペースバーを扱う場合のレイアウトです。スイッチプレートの赤い印の部分をニッパーなどでカットして使います。  
    ![coron47plus_layout_02](/images/layout_02.jpg)

  - レイアウト③  
    2.25uのスペースバーを扱う場合のレイアウトです。レイアウト②の加工に加え、スイッチプレートの黄色い印の部分をニッパーなどでカットしてください。非常に繊細なので、プレートを切断しないように気を付けてください。なお中央の2.25uのキーにスタビライザーを用いない場合はこの加工は不要です。  
    ![coron47plus_layout_03](/images/layout_03.jpg)

### 25mmボールについて

キットには直径約25.4mmのビリヤードボールが付属しています。このビリヤードボールはトラックボール用として製造されているものではないので、市販のものと比較するとトラッキング性能やスムーズさで劣ります。あくまで動作確認用としてお使いください。
市販の25mm球を搭載したトラックボールのボールを取り出してcoron47plusにお使いいただくことをお勧めします。

また、25.4mmのビリヤードボールと25mmのトラックボールの微妙な寸法差に対応するため、初期ロットは2種類のボールケースを付属しています。裏面に円形の切り欠きがあるものが25mmボール用、ないものが25.4mmビリヤードボール用となっています。25mmボール用ケースにビリヤードボールをはめようとするとケース破損の原因となりますので、十分にお気をつけください。

![coron47plus_25mm_ballcase](/images/25mm_ballcase.jpg)


## ファームウェア

  [REMAP](https://remap-keys.app/catalog/0A8mzTxVdzGgI9rzv5EE/firmware)からファームウェアのダウンロードおよびProMicroへの書き込みを行うことができます。キーマップは[こちら](https://remap-keys.app/configure)から更新可能です。  
トラックボール、LED含めて上記.hexファイルで確認いただけます。

（.hexファイルをQMK ToolboxなどでProMicroに書き込む従来の方法でも問題ありません。）


組み立て段階で動作確認をする際も、REMAPのTest Matrix Modeを使うと便利です。ただし、Test Matrix Modeではロータリーエンコーダの回転は確認できないので、別途キー入力等で動作を試してください。

標準ファームウェアでは、レイヤー1と2でトラックボールの動きがスクロールに変換されるようになっています。スクロールモードになるレイヤーを変更したい場合は、keymap.cを修正してください。

ソースコードは[こちら](https://github.com/aki27kbd/qmk_firmware/tree/master/keyboards/aki27/coron47plus)を参照ください。  
また、VIA用のjsonファイルは[こちら](https://github.com/aki27kbd/coron47plus/blob/main/firmware/cocot46plus_via.json)を参照ください。


## カスタムキーコード

  トラックボールの操作に関していくつかカスタムキーコードを設定することが可能です。

  Value    | Keycode   |Description
  ---------|-----------|-----------
  `0x5DA7` | `CPI_SW`  |トラックボールのCPIを変更します。デフォルトのファームウェアでは、押すたびに500→750→1000→1250→500…という順番でCPIが変わります。
  `0x5DA8` | `SCRL_SW` |スクロールモードにおけるセンサーの感度を変更します。数値が大きいほどスクロール量が小さくなります。
  `0x5DA9` | `ROT_R15` |マウスセンサーのＹ軸を時計回りに15度回転させます。
  `0x5DAA` | `ROT_L15` |マウスセンサーのＹ軸を反時計回りに15度回転させます。
  `0x5DAB` | `SCRL_MO` |押されている間スクロールモードになります。
  `0x5DAC` | `SCRL_TO` |押すたびにスクロールモードとマウスモードを切り替えます。
  `0x5DAD` | `SCRL_IN` |スクロール方向を反転させます。

  REMAPでカスタムキーコードを設定する場合はFunctionタブ下のカスタムキーコードを用いて設定することが可能です。  
  ![CustomKeycode_rev](/images/CustomKeycode.jpg)


## Links

  [【大注目！】トラックボール付き自作キーボード cocot36plus/coron47plus レビュー | Trackball Mechanical Keyboard Review](https://www.youtube.com/watch?v=GIpaJPnjrzo) (by Daihukuさん)  
  トラックボールの使い心地、内部構造など紹介いただいています。

  [Gallery on Twitter](https://twitter.com/search?q=%23coron47plus&src=typed_query&f=image)


## 終わりに
何かトラブルがあれば[Twitterアカウント](https://twitter.com/aki27kbd)までご連絡ください。

また、完成写真をSNSにアップいただけるととても励みになります。（アップするのがはばかられる方はDMで直接送りつけていただいても構いません。）

ハッシュタグは #coron47plus です。
